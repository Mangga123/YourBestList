<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <title>Agenda Digital</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap"
      rel="stylesheet"
    />

    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Poppins", sans-serif;
      }

      body {
        background: #f4f6f9;
        color: #333;
        padding: 15px;
      }

      h1,
      h2 {
        text-align: center;
        margin-bottom: 15px;
        color: #2c3e50;
      }

      .container {
        max-width: 1200px;
        margin: auto;
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
      }

      .card {
        background: #fff;
        border-radius: 12px;
        padding: 15px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
      }

      label {
        font-weight: 600;
        display: block;
        margin-top: 10px;
      }

      input,
      select {
        width: 100%;
        padding: 8px;
        margin-top: 5px;
        border-radius: 8px;
        border: 1px solid #ccc;
        outline: none;
        transition: border 0.2s;
        font-size: 14px;
      }

      input:focus,
      select:focus {
        border-color: #3498db;
      }

      button {
        margin-top: 12px;
        padding: 10px 15px;
        border: none;
        border-radius: 8px;
        background: #3498db;
        color: white;
        font-weight: 600;
        cursor: pointer;
        transition: 0.2s;
        font-size: 14px;
      }

      button:hover {
        background: #2980b9;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
        font-size: 14px;
      }

      th,
      td {
        padding: 10px;
        text-align: center;
        border-bottom: 1px solid #eee;
      }

      th {
        background: #3498db;
        color: white;
      }

      .done {
        text-decoration: line-through;
        color: gray;
      }

      .btn-danger {
        background: #e74c3c;
      }

      .btn-danger:hover {
        background: #c0392b;
      }

      .btn-reset {
        background: #f39c12;
      }

      .btn-reset:hover {
        background: #d35400;
      }

      .sks-info {
        margin-top: 10px;
        font-weight: 600;
        color: #27ae60;
      }

      /* üîπ Responsif untuk layar kecil */
      @media (max-width: 900px) {
        .container {
          grid-template-columns: 1fr;
        }

        body {
          padding: 10px;
        }

        h1 {
          font-size: 20px;
        }

        h2 {
          font-size: 16px;
        }

        table {
          display: block;
          overflow-x: auto;
          white-space: nowrap;
        }
      }
    </style>
  </head>
  <body>
    <h1>üìÖ Agenda Digital</h1>
    <div class="container">
      <!-- Input Jadwal -->
      <div class="card">
        <h2>Tambah Jadwal</h2>
        <label>Mata Kuliah</label>
        <input type="text" id="matkul" />

        <label>Hari</label>
        <select id="hari">
          <option>Senin</option>
          <option>Selasa</option>
          <option>Rabu</option>
          <option>Kamis</option>
          <option>Jumat</option>
          <option>Sabtu</option>
        </select>

        <label>Jam</label>
        <input type="time" id="jam" />

        <label>Ruang</label>
        <input type="text" id="ruang" />

        <label>Dosen</label>
        <input type="text" id="dosen" />

        <label>SKS</label>
        <input type="number" id="sks" min="1" max="6" />

        <button onclick="tambahJadwal()">+ Tambah Jadwal</button>
        <button class="btn-reset" onclick="resetSKS()">üîÑ Reset SKS</button>
        <button class="btn-reset" onclick="resetTugas()">üßπ Reset Tugas</button>
        <div class="sks-info">Total SKS: <span id="totalSKS">0</span></div>
      </div>

      <!-- Input Tugas -->
      <div class="card">
        <h2>Tambah Tugas</h2>
        <label>Nama Tugas</label>
        <input type="text" id="tugas" />

        <label>Deadline</label>
        <input type="date" id="deadline" />

        <button onclick="tambahTugas()">+ Tambah Tugas</button>
      </div>
    </div>

    <!-- Daftar Jadwal -->
    <div class="card" style="margin-top: 20px">
      <h2>üìö Jadwal Kuliah</h2>
      <table id="jadwalTable">
        <tr>
          <th>Mata Kuliah</th>
          <th>Hari</th>
          <th>Jam</th>
          <th>Ruang</th>
          <th>Dosen</th>
          <th>SKS</th>
        </tr>
      </table>
    </div>

    <!-- Daftar Tugas -->
    <div class="card" style="margin-top: 20px">
      <h2>üìù Daftar Tugas</h2>
      <table id="tugasTable">
        <tr>
          <th>Tugas</th>
          <th>Deadline</th>
          <th>Status</th>
        </tr>
      </table>
    </div>

    <script>
      let jadwal = [];
      let tugas = [];

      async function loadData() {
        const res = await fetch("/api/data");
        const data = await res.json();
        jadwal = data.jadwal;
        tugas = data.tugas;
        tampilkan();
      }

      async function saveData() {
        await fetch("/api/data", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ jadwal, tugas }),
        });
      }

      function tampilkan() {
        let jadwalTable = document.getElementById("jadwalTable");
        jadwalTable.innerHTML =
          "<tr><th>Mata Kuliah</th><th>Hari</th><th>Jam</th><th>Ruang</th><th>Dosen</th><th>SKS</th></tr>";
        let total = 0;
        jadwal.forEach((j) => {
          let row = jadwalTable.insertRow();
          j.forEach((val) => {
            let cell = row.insertCell();
            cell.innerText = val;
          });
          total += parseInt(j[5]);
        });
        document.getElementById("totalSKS").innerText = total;

        let tugasTable = document.getElementById("tugasTable");
        tugasTable.innerHTML =
          "<tr><th>Tugas</th><th>Deadline</th><th>Status</th></tr>";
        tugas.forEach((t, idx) => {
          let row = tugasTable.insertRow();
          row.insertCell().innerText = t[0];
          row.insertCell().innerText = t[1];
          let cell = row.insertCell();
          if (t[2]) {
            cell.innerHTML = `<span class="done">Selesai</span>`;
          } else {
            cell.innerHTML = `<button class="btn-danger" onclick="selesaikanTugas(${idx})">Selesai</button>`;
          }
        });
      }

      function tambahJadwal() {
        let matkul = document.getElementById("matkul").value;
        let hari = document.getElementById("hari").value;
        let jam = document.getElementById("jam").value;
        let ruang = document.getElementById("ruang").value;
        let dosen = document.getElementById("dosen").value;
        let sks = document.getElementById("sks").value;
        if (matkul && jam && ruang && dosen && sks) {
          jadwal.push([matkul, hari, jam, ruang, dosen, sks]);
          saveData();
          tampilkan();
        }
      }

      function tambahTugas() {
        let nama = document.getElementById("tugas").value;
        let deadline = document.getElementById("deadline").value;
        if (nama && deadline) {
          tugas.push([nama, deadline, false]);
          saveData();
          tampilkan();
        }
      }

      function selesaikanTugas(i) {
        tugas[i][2] = true;
        saveData();
        tampilkan();
      }

      function resetSKS() {
        if (confirm("Yakin ingin mengreset semua SKS yang sudah tercantum?")) {
          jadwal = [];
          saveData();
          tampilkan();
        }
      }

      function resetTugas() {
        if (confirm("Yakin ingin menghapus semua daftar tugas?")) {
          tugas = [];
          saveData();
          tampilkan();
        }
      }

      loadData();
    </script>
  </body>
</html>
